define ("qtype_kekule_chem_base/editForm",["kekule"],function(){function a(){function a(){for(var a=[],b=document.getElementsByTagName("textarea"),c=0,d=b.length,e;c<d;++c){e=b[c].className;if(e&&0<=e.indexOf("K-Chem-Question-Design-AnswerBlank")){a.push(b[c])}}return a}function b(a){var b=null,c=a[0],d=c&&c.form;if(d){var e=d.elements.inputtype;b=e&&e.value}return b}function c(a){for(var c=b(a),e=0,f=a.length;e<f;++e){var g=a[e],h=g.value,j=null,k=null;try{var l=JSON.parse(h);j=l.molData;k=l.molDataType}catch(a){}var m=g.getAttribute("data-widget-class");d(g,j,k,m,c)}}function d(a,b,c,d,i){var j=Kekule.ChemWidget.ComponentWidgetNames,k=a.name||"",l=f(a);if(0<=l){var m={};if("1"===i){m.restrainEditorWithCurrObj=!1;m.editorProperties={allowCreateNewChild:!0}}else{m.restrainEditorWithCurrObj=!0;m.editorProperties={predefinedSetting:"molOnly",allowCreateNewChild:!1}}var n=document.createElement("span"),o=document.createElement("br"),p=a.parentNode;p.insertBefore(n,a);p.insertBefore(o,a);h(a);var q=new Kekule.ChemWidget.Viewer(n);q.setPropValues(m);q.setPredefinedSetting("editOnly").setToolButtons([j.loadData,j.saveData,j.openEditor]).setResizable(!0).setEnableEditFromVoid(!0);if(d)q.addClassName(d);if(b){var r=c||Kekule.IO.MimeType.KEKULE_JSON;try{var s=Kekule.IO.loadMimeData(b,r);if(s)q.setChemObj(s)}catch(a){console.error(a)}}q.__answerIndex__=l;var t=g(l);q.__answerRelElems__=t;q.on("load",e);return q}else return null}function e(a){var b=a.currentTarget||a.target;if(b instanceof Kekule.ChemWidget.Viewer){var c=b.getElement(),d=b.__answerRelElems__,e=d.answer;if(e){var f="",g="",h="",i=b.getChemObj();if(i){var j="";try{f=Kekule.IO.saveMimeData(i,Kekule.IO.MimeType.KEKULE_JSON);g=Kekule.IO.saveMimeData(i,Kekule.IO.MimeType.SMILES,{ignoreStereo:!1});h=Kekule.IO.saveMimeData(i,Kekule.IO.MimeType.SMILES,{ignoreStereo:!0})}catch(a){}var k={smiles:g,smilesNoStereo:h,molDataType:Kekule.IO.MimeType.KEKULE_JSON,molData:f};j=JSON.stringify(k)}e.value=j}}}function f(a){var b=-1,c=a.name,d=c.match(/\[(\d+)\]/);if(d){b=parseInt(d[1])}return b}function g(a){return{answer:document.getElementsByName("answer["+a+"]")[0]}}function h(a){a.style.display="none"}Kekule.X.domReady(function(){if(Kekule.Editor.ChemSpaceEditorConfigs&&Kekule.Editor.ChemSpaceEditorConfigs.getInstance){var b=Kekule.Editor.ChemSpaceEditorConfigs.getInstance();b.getInteractionConfigs().setAllowUnknownAtomSymbol(!1)}var d=a();c(d)})}return{init:function init(){Kekule._ready(a)}}});
//# sourceMappingURL=editForm.min.js.map
