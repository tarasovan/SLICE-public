define ("local_kekulejs/kekuleMoodle",["kekule","local_kekulejs/kekuleInitials"],function(){function a(){var a=window,b={WidgetDataWrapper:{WRAPPER_HTML_CLASS:"KekuleMoodle-Widget-Data-Wrapper",WRAPPER_DATA_HTML_CLASS:"KekuleMoodle-Widget-Data",ALLOWED_TAGNAMES:["div","span","img","p","section"],ALLOWED_ATTRIBS:["class","style","id","name","width","height",/^data-/],_matchAttribPatterns:function _matchAttribPatterns(a,b){for(var c=0,d=b.length;c<d;++c){if(a.match(b[c]))return!0}return!1},convertWrapperElem:function convertWrapperElem(a,c){var d=Kekule.HtmlElementUtils.getInnerText(a);try{var e=JSON.parse(d);if(e){var f=e.tagName||a.tagName;if(0>b.WidgetDataWrapper.ALLOWED_TAGNAMES.indexOf(f.toLowerCase()))return null;Kekule.DomUtils.clearChildContent(a);var g=a,h=!1;if(e.tagName){g=a.ownerDocument.createElement(e.tagName);h=!0}for(var i in e){if("tagName"!=i&&b.WidgetDataWrapper._matchAttribPatterns(i,b.WidgetDataWrapper.ALLOWED_ATTRIBS)){var j=e[i];g.setAttribute(i,j);console.log("set attrib",i,j)}}Kekule.HtmlElementUtils.removeClass(a,b.WidgetDataWrapper.WRAPPER_HTML_CLASS);if(h)a.appendChild(g);if(c)Kekule.Widget.autoLauncher.execute(g)}}catch(a){}},launchOnElem:function launchOnElem(a){if(a.isContentEditable)return;if(Kekule.Widget.getWidgetOnElem(a,!0))return;if(Kekule.HtmlElementUtils.hasClass(a,b.WidgetDataWrapper.WRAPPER_HTML_CLASS)){b.WidgetDataWrapper.convertWrapperElem(a,!0)}else{for(var c=Kekule.DomUtils.getDirectChildElems(a),d=0,e=c.length,f;d<e;++d){f=c[d];this.launchOnElem(f)}}},launchOnDoc:function launchOnDoc(a){if(!a)a=document;b.WidgetDataWrapper.launchOnElem(a.body)}}};a.KekuleMoodle=b;Kekule.X.domReady(function(){b.WidgetDataWrapper.launchOnDoc(document)})}return{init:function init(){Kekule._ready(a)}}});
//# sourceMappingURL=kekuleMoodle.min.js.map
